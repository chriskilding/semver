.Dd February 19, 2019
.Dt SEMVER 1
.Os
.Sh NAME
.Nm semver
.Nd Semantic Versioning utility
.Sh SYNOPSIS
.Nm
.Op Fl hqst
.Sh DESCRIPTION
The
.Nm
utility can search text from the standard input, select any Semantic Version strings that are
present, and write them to the standard output. It can optionally sort or tabulate the selected
versions.
.Pp
A
.Sq version
string will be matched within the text stream if the following criteria are met:
.Bl -bullet -compact
.It
.Sq version
is a valid Semantic Version.
.It
.Sq version
is a whole word.
.It
.Sq version
has whitespace immediately before it, OR its first character is also the first character of the line.
.It
.Sq version
has whitespace immediately after it, OR its last character is also the last character of the line.
.El
.Pp
Example:
.Pp
.Bd -literal -offset indent
$ semver <<EOF
foo 1.1.1
bar
baz 1.0.0-alpha+1 qux 2.2.2
EOF

1.1.1
1.0.0-alpha+1
2.2.2
.Ed
.Sh OPTIONS
.Pp
The
.Nm
utility understands the following command-line options:
.Bl -tag -width Ds indent
.It Fl h, -help
Display the usage screen.
.It Fl q, -quiet
Quiet mode. Nothing shall be written to the standard output, regardless of matching Semantic Versions. The utility will exit immediately with zero status if a Semantic Version string is selected.
.Pp
Example:
.Pp
.Bd -literal -offset indent
semver -q <<< '1.2.3'    # => 0
semver -q <<< 'invalid'  # => 1
.Ed
.It Fl s, -sort
Sort the matched versions in precedence order (low-to-high).
.Pp
Example:
.Pp
.Bd -literal -offset indent
$ semver -s <<EOF
2.2.2
1.1.1
4.4.4
EOF

1.1.1
2.2.2
4.4.4
.Ed
.It Fl t, -tabulate
Tabulate the matched versions (separator: '\\t').
.Pp
Example:
.Pp
.Bd -literal -offset indent
$ semver -t <<EOF
1.0.0
1.0.0-alpha
1.0.0+1
1.0.0-alpha+1
EOF

1   0   0
1   0   0   alpha
1   0   0           1
1   0   0   alpha   1
.Ed
.El
.Sh EXAMPLES
.Pp
\fBCut\fR out the major, minor, and patch components of a version:
.Pp
.Bd -literal -offset indent -compact
semver -t <<< $version | cut -f 1-3
.Ed
.Pp
\fBFind\fR Semantic Versions in filenames inside a directory:
.Pp
.Bd -literal -offset indent -compact
find . -type f | semver
.Ed
.Pp
\fBFormat\fR a version string as CSV:
.Pp
.Bd -literal -offset indent -compact
semver -t <<< $version | tr '\\t' ','
.Ed
.Pp
\fBGet\fR the current Git tag:
.Pp
.Bd -literal -offset indent -compact
git tag | semver -s | tail -n 1
.Ed
.Pp
\fBIncrement\fR the Git tag:
.Pp
.Bd -literal -offset indent -compact
git tag | semver -st | tail -n 1 | awk -F '\\t' '{ print $1 "." 0 "." 0 }'      # major++

git tag | semver -st | tail -n 1 | awk -F '\\t' '{ print $1 "." $2 "." 0 }'     # minor++

git tag | semver -st | tail -n 1 | awk -F '\\t' '{ print $1 "." $2 "." ++$3 }'  # patch++
.Ed
.Pp
\fBValidate\fR a candidate version string:
.Pp
.Bd -literal -offset indent
semver -q <<< $version && echo 'ok'
.Ed
.Sh EXIT STATUS
The
.Nm
utility exits with one of the following values:
.Pp
.Bl -tag -width flag -compact
.It Li 0
One or more Semantic Versions were matched.
.It Li >0
No Semantic Versions were matched, or an error occurred.
.El
.Sh WARNINGS
The Semantic Versioning standard does not define an ordering for two versions that are precedence-equal but stringwise-unequal (for example the BUILD is different). To guarantee predictable ordering between executions, the
.Nm
utility applies an additional natural sort on top of the Semantic Version precedence sort. This additional sort is IMPLEMENTATION-SPECIFIC and SUBJECT TO CHANGE between releases, so its algorithm is deliberately left undocumented. You should not rely on it.
.Sh STANDARDS
The
.Nm
utility is expected to conform to the Semantic Versioning standard, defined at https://semver.org.
